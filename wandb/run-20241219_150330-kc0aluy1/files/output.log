
=== MODEL INFO ===
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
Sam                                                --
├─ImageEncoderViT: 1-1                             3,145,728
│    └─PatchEmbed: 2-1                             --
│    │    └─Conv2d: 3-1                            (590,592)
│    └─ModuleList: 2-2                             --
│    │    └─Block: 3-2                             (7,091,328)
│    │    └─Block: 3-3                             (7,091,328)
│    │    └─Block: 3-4                             (7,104,128)
│    │    └─Block: 3-5                             (7,091,328)
│    │    └─Block: 3-6                             (7,091,328)
│    │    └─Block: 3-7                             (7,104,128)
│    │    └─Block: 3-8                             (7,091,328)
│    │    └─Block: 3-9                             (7,091,328)
│    │    └─Block: 3-10                            (7,104,128)
│    │    └─Block: 3-11                            (7,091,328)
│    │    └─Block: 3-12                            (7,091,328)
│    │    └─Block: 3-13                            (7,104,128)
│    └─Sequential: 2-3                             --
│    │    └─Conv2d: 3-14                           (196,608)
│    │    └─LayerNorm2d: 3-15                      (512)
│    │    └─Conv2d: 3-16                           (589,824)
│    │    └─LayerNorm2d: 3-17                      (512)
├─PromptEncoder: 1-2                               --
│    └─PositionEmbeddingRandom: 2-4                --
│    └─ModuleList: 2-5                             --
│    │    └─Embedding: 3-18                        (256)
│    │    └─Embedding: 3-19                        (256)
│    │    └─Embedding: 3-20                        (256)
│    │    └─Embedding: 3-21                        (256)
│    └─Embedding: 2-6                              (256)
│    └─Sequential: 2-7                             --
│    │    └─Conv2d: 3-22                           (20)
│    │    └─LayerNorm2d: 3-23                      (8)
│    │    └─GELU: 3-24                             --
│    │    └─Conv2d: 3-25                           (272)
│    │    └─LayerNorm2d: 3-26                      (32)
│    │    └─GELU: 3-27                             --
│    │    └─Conv2d: 3-28                           (4,352)
│    └─Embedding: 2-8                              (256)
├─MaskDecoder: 1-3                                 --
│    └─TwoWayTransformer: 2-9                      --
│    │    └─ModuleList: 3-29                       3,159,040
│    │    └─Attention: 3-30                        131,712
│    │    └─LayerNorm: 3-31                        512
│    └─Embedding: 2-10                             256
│    └─Embedding: 2-11                             1,024
│    └─Sequential: 2-12                            --
│    │    └─ConvTranspose2d: 3-32                  65,600
│    │    └─LayerNorm2d: 3-33                      128
│    │    └─GELU: 3-34                             --
│    │    └─ConvTranspose2d: 3-35                  8,224
│    │    └─GELU: 3-36                             --
│    └─ModuleList: 2-13                            --
│    │    └─MLP: 3-37                              139,808
│    │    └─MLP: 3-38                              139,808
│    │    └─MLP: 3-39                              139,808
│    │    └─MLP: 3-40                              139,808
│    └─MLP: 2-14                                   --
│    │    └─ModuleList: 3-41                       132,612
├─ConvAdapter: 1-4                                 --
│    └─Conv2d: 2-15                                1,792
│    └─ConvBlock: 2-16                             --
│    │    └─Conv2d: 3-42                           590,080
│    │    └─BatchNorm2d: 3-43                      512
│    │    └─LeakyReLU: 3-44                        --
│    │    └─AvgPool2d: 3-45                        --
│    └─ConvBlock: 2-17                             --
│    │    └─Conv2d: 3-46                           590,080
│    │    └─BatchNorm2d: 3-47                      512
│    │    └─LeakyReLU: 3-48                        --
│    │    └─AvgPool2d: 3-49                        --
│    └─ConvBlock: 2-18                             --
│    │    └─Conv2d: 3-50                           590,080
│    │    └─BatchNorm2d: 3-51                      512
│    │    └─LeakyReLU: 3-52                        --
│    │    └─AvgPool2d: 3-53                        --
│    └─AdaptiveAvgPool2d: 2-19                     --
===========================================================================
Total params: 95,509,040
Trainable params: 5,831,908
Non-trainable params: 89,677,132
===========================================================================
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:13<00:00,  1.41it/s]

epoch 01, bce_loss: 0.34082, iou_loss: 0.50025, dice: 0.67331, iou: 0.56937
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:11<00:00,  1.43it/s]
epoch 02, bce_loss: 0.24731, iou_loss: 0.37554, dice: 0.78564, iou: 0.68540
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:09<00:00,  1.46it/s]
epoch 03, bce_loss: 0.22013, iou_loss: 0.33748, dice: 0.80890, iou: 0.71343
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:07<00:00,  1.47it/s]
epoch 04, bce_loss: 0.21221, iou_loss: 0.32791, dice: 0.81593, iou: 0.72285
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:07<00:00,  1.48it/s]
epoch 05, bce_loss: 0.20534, iou_loss: 0.31796, dice: 0.82314, iou: 0.73073
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:06<00:00,  1.49it/s]
epoch 06, bce_loss: 0.19389, iou_loss: 0.30235, dice: 0.83465, iou: 0.74282
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:04<00:00,  1.50it/s]
epoch 07, bce_loss: 0.18559, iou_loss: 0.29345, dice: 0.83922, iou: 0.74958
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:02<00:00,  1.53it/s]
epoch 08, bce_loss: 0.18602, iou_loss: 0.29491, dice: 0.83574, iou: 0.74683
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:02<00:00,  1.53it/s]
epoch 09, bce_loss: 0.18214, iou_loss: 0.29037, dice: 0.84173, iou: 0.75309
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:02<00:00,  1.53it/s]
epoch 10, bce_loss: 0.17963, iou_loss: 0.28800, dice: 0.84129, iou: 0.75290
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:02<00:00,  1.54it/s]
epoch 11, bce_loss: 0.18001, iou_loss: 0.28887, dice: 0.84063, iou: 0.75153
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:02<00:00,  1.54it/s]
epoch 12, bce_loss: 0.16668, iou_loss: 0.28070, dice: 0.84616, iou: 0.75783
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:01<00:00,  1.54it/s]
epoch 13, bce_loss: 0.17849, iou_loss: 0.27885, dice: 0.84659, iou: 0.75914
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:02<00:00,  1.54it/s]
epoch 14, bce_loss: 0.17105, iou_loss: 0.28159, dice: 0.84461, iou: 0.75787
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:01<00:00,  1.55it/s]
epoch 15, bce_loss: 0.17706, iou_loss: 0.28168, dice: 0.84667, iou: 0.75886
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:01<00:00,  1.55it/s]
epoch 16, bce_loss: 0.16322, iou_loss: 0.27096, dice: 0.85186, iou: 0.76635
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:02<00:00,  1.54it/s]
epoch 17, bce_loss: 0.17375, iou_loss: 0.27827, dice: 0.84771, iou: 0.76073
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:03<00:00,  1.53it/s]
epoch 18, bce_loss: 0.16347, iou_loss: 0.26651, dice: 0.85387, iou: 0.76940
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:02<00:00,  1.54it/s]
epoch 19, bce_loss: 0.17206, iou_loss: 0.27058, dice: 0.85299, iou: 0.76754
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:01<00:00,  1.55it/s]
epoch 20, bce_loss: 0.16702, iou_loss: 0.27317, dice: 0.85001, iou: 0.76497
Model checkpoint saved at: checkpoints/Dec19_150328_cad.pth
