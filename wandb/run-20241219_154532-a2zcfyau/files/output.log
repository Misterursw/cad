
=== MODEL INFO ===
===========================================================================
Layer (type:depth-idx)                             Param #
===========================================================================
Sam                                                --
├─ImageEncoderViT: 1-1                             3,120,384
│    └─PatchEmbed: 2-1                             --
│    │    └─Conv2d: 3-1                            (590,592)
│    └─Linear: 2-2                                 147,648
│    └─Linear: 2-3                                 147,648
│    └─Linear: 2-4                                 25,344
│    └─ModuleList: 2-5                             --
│    │    └─Adapter: 3-2                           31,520
│    │    └─Adapter: 3-3                           31,520
│    │    └─Adapter: 3-4                           31,520
│    │    └─Adapter: 3-5                           31,520
│    │    └─Adapter: 3-6                           31,520
│    │    └─Adapter: 3-7                           31,520
│    │    └─Adapter: 3-8                           31,520
│    │    └─Adapter: 3-9                           31,520
│    │    └─Adapter: 3-10                          31,520
│    │    └─Adapter: 3-11                          31,520
│    │    └─Adapter: 3-12                          31,520
│    │    └─Adapter: 3-13                          31,520
│    │    └─Adapter: 3-14                          31,520
│    └─ModuleList: 2-6                             --
│    │    └─Block: 3-15                            (7,091,328)
│    │    └─Block: 3-16                            (7,091,328)
│    │    └─Block: 3-17                            (7,104,128)
│    │    └─Block: 3-18                            (7,091,328)
│    │    └─Block: 3-19                            (7,091,328)
│    │    └─Block: 3-20                            (7,104,128)
│    │    └─Block: 3-21                            (7,091,328)
│    │    └─Block: 3-22                            (7,091,328)
│    │    └─Block: 3-23                            (7,104,128)
│    │    └─Block: 3-24                            (7,091,328)
│    │    └─Block: 3-25                            (7,091,328)
│    │    └─Block: 3-26                            (7,104,128)
│    └─Sequential: 2-7                             --
│    │    └─Conv2d: 3-27                           (196,608)
│    │    └─LayerNorm2d: 3-28                      (512)
│    │    └─Conv2d: 3-29                           (589,824)
│    │    └─LayerNorm2d: 3-30                      (512)
├─PromptEncoder: 1-2                               --
│    └─PositionEmbeddingRandom: 2-8                --
│    └─ModuleList: 2-9                             --
│    │    └─Embedding: 3-31                        (256)
│    │    └─Embedding: 3-32                        (256)
│    │    └─Embedding: 3-33                        (256)
│    │    └─Embedding: 3-34                        (256)
│    └─Embedding: 2-10                             (256)
│    └─Sequential: 2-11                            --
│    │    └─Conv2d: 3-35                           (20)
│    │    └─LayerNorm2d: 3-36                      (8)
│    │    └─GELU: 3-37                             --
│    │    └─Conv2d: 3-38                           (272)
│    │    └─LayerNorm2d: 3-39                      (32)
│    │    └─GELU: 3-40                             --
│    │    └─Conv2d: 3-41                           (4,352)
│    └─Embedding: 2-12                             (256)
├─MaskDecoder: 1-3                                 --
│    └─TwoWayTransformer: 2-13                     --
│    │    └─ModuleList: 3-42                       3,159,040
│    │    └─Attention: 3-43                        131,712
│    │    └─LayerNorm: 3-44                        512
│    └─Embedding: 2-14                             256
│    └─Embedding: 2-15                             1,024
│    └─Sequential: 2-16                            --
│    │    └─ConvTranspose2d: 3-45                  65,600
│    │    └─LayerNorm2d: 3-46                      128
│    │    └─GELU: 3-47                             --
│    │    └─ConvTranspose2d: 3-48                  8,224
│    │    └─GELU: 3-49                             --
│    └─ModuleList: 2-17                            --
│    │    └─MLP: 3-50                              139,808
│    │    └─MLP: 3-51                              139,808
│    │    └─MLP: 3-52                              139,808
│    │    └─MLP: 3-53                              139,808
│    └─MLP: 2-18                                   --
│    │    └─ModuleList: 3-54                       132,612
===========================================================================
Total params: 94,440,528
Trainable params: 4,788,740
Non-trainable params: 89,651,788
===========================================================================
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:30<00:00,  1.25it/s]

epoch 01, bce_loss: 0.34886, iou_loss: 0.47204, dice: 0.69878, iou: 0.60217
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:32<00:00,  1.23it/s]
epoch 02, bce_loss: 0.21160, iou_loss: 0.31360, dice: 0.82635, iou: 0.73809
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:32<00:00,  1.23it/s]
epoch 03, bce_loss: 0.18453, iou_loss: 0.27829, dice: 0.84713, iou: 0.76343
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:33<00:00,  1.23it/s]
epoch 04, bce_loss: 0.18194, iou_loss: 0.27414, dice: 0.84909, iou: 0.76670
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:33<00:00,  1.22it/s]
epoch 05, bce_loss: 0.18736, iou_loss: 0.27791, dice: 0.84704, iou: 0.76426
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:29<00:00,  1.26it/s]
epoch 06, bce_loss: 0.15774, iou_loss: 0.25088, dice: 0.86263, iou: 0.78373
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:33<00:00,  1.23it/s]
epoch 07, bce_loss: 0.15762, iou_loss: 0.24432, dice: 0.86925, iou: 0.79070
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:30<00:00,  1.25it/s]
epoch 08, bce_loss: 0.14693, iou_loss: 0.23527, dice: 0.87400, iou: 0.79623
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:33<00:00,  1.22it/s]
epoch 09, bce_loss: 0.14451, iou_loss: 0.22840, dice: 0.87884, iou: 0.80339
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:29<00:00,  1.26it/s]
epoch 10, bce_loss: 0.14814, iou_loss: 0.23151, dice: 0.87432, iou: 0.79877
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:27<00:00,  1.28it/s]
epoch 11, bce_loss: 0.13857, iou_loss: 0.22753, dice: 0.87879, iou: 0.80271
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:36<00:00,  1.20it/s]
epoch 12, bce_loss: 0.13728, iou_loss: 0.22252, dice: 0.88240, iou: 0.80750
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:36<00:00,  1.20it/s]
epoch 13, bce_loss: 0.13721, iou_loss: 0.22440, dice: 0.87926, iou: 0.80416
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:35<00:00,  1.21it/s]
epoch 14, bce_loss: 0.13137, iou_loss: 0.21808, dice: 0.88534, iou: 0.81106
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:33<00:00,  1.22it/s]
epoch 15, bce_loss: 0.13336, iou_loss: 0.21633, dice: 0.88502, iou: 0.81132
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:34<00:00,  1.22it/s]
epoch 16, bce_loss: 0.13227, iou_loss: 0.21509, dice: 0.88554, iou: 0.81220
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:35<00:00,  1.21it/s]
epoch 17, bce_loss: 0.13244, iou_loss: 0.21714, dice: 0.88467, iou: 0.81090
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:33<00:00,  1.23it/s]
epoch 18, bce_loss: 0.13072, iou_loss: 0.21747, dice: 0.88480, iou: 0.81111
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:31<00:00,  1.24it/s]
epoch 19, bce_loss: 0.13411, iou_loss: 0.21773, dice: 0.88399, iou: 0.81014
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 188/188 [02:27<00:00,  1.28it/s]
epoch 20, bce_loss: 0.12753, iou_loss: 0.21210, dice: 0.88776, iou: 0.81486
Model checkpoint saved at: checkpoints/Dec19_154531_sa.pth
